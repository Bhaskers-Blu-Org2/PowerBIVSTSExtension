{
  "manifestVersion": 1,
  "id": "PowerBI",
  "version": "0.0.59",
  "name": "PowerBI Extension for VSTS",
  "publisher": "MicrosoftPowerBIExtensions",
  "description": "Integration tools for PowerBI which use the official API calls",
  "targets": [
    {
      "id": "Microsoft.VisualStudio.Services"
    }
  ],
  "icons": {
    "default": "icon.png"
  },
  "categories": [
    "Build and release"
  ],
  "tags": [
    "PowerBI",
    "business intelligence"
  ],
  "files": [
    {
      "path": "ImportFile"
    },
    {
      "path": "ImportFileToGroup"
    },
    {
      "path": "images",
      "addressable": true
    },
    {
      "path": "AddGroup"
    },
    {
      "path": "AddGroup/icon.png"
    },
    {
      "path": "AddGroup/PowerShell/Library.psm1"
    },
    {
      "path": "AddGroup/PowerShell/CapacityOperations.psm1"
    },
    {
      "path": "AddGroup/PowerShell/DatasetOperations.psm1"
    },
    {
      "path": "AddGroup/PowerShell/TableOperations.psm1"
    },
    {
      "path": "AddGroup/PowerShell/RowOperations.psm1"
    },
    {
      "path": "AddGroup/PowerShell/GroupOperations.psm1"
    },
    {
      "path": "AddGroup/PowerShell/ImportOperations.psm1"
    },
    {
      "path": "AddGroup/PowerShell/DashboardOperations.psm1"
    },
    {
      "path": "AddGroup/PowerShell/ReportOperations.psm1"
    },
    {
      "path": "AddGroup/PowerShell/DatasourceOperations.psm1"
    },
    {
      "path": "AddGroup/PowerShell/GatewayOperations.psm1"
    },
    {
      "path": "AddGroup/PowerShell/Microsoft.IdentityModel.Clients.ActiveDirectory.dll"
    },
    {
      "path": "AddGroup/PowerShell/Microsoft.IdentityModel.Clients.ActiveDirectory.WindowsForms.dll"
    },
    {
      "path": "AddGroup/runtask.ps1"
    },
    {
      "path": "AddGroup/ps_modules"
    },
    {
      "path": "AddGroup/ps_modules/VstsTaskSdk"
    },
    {
      "path": "AddGroup/task.json"
    },
    {
      "path": "AddGroup/ps_modules/VstsTaskSdk/VstsTaskSdk.dll"
    },
    {
      "path": "DeleteGroup"
    },
    {
      "path": "DeleteGroup/icon.png"
    },
    {
      "path": "DeleteGroup/PowerShell/Library.psm1"
    },
    {
      "path": "DeleteGroup/PowerShell/CapacityOperations.psm1"
    },
    {
      "path": "DeleteGroup/PowerShell/DatasetOperations.psm1"
    },
    {
      "path": "DeleteGroup/PowerShell/TableOperations.psm1"
    },
    {
      "path": "DeleteGroup/PowerShell/RowOperations.psm1"
    },
    {
      "path": "DeleteGroup/PowerShell/GroupOperations.psm1"
    },
    {
      "path": "DeleteGroup/PowerShell/ImportOperations.psm1"
    },
    {
      "path": "DeleteGroup/PowerShell/DashboardOperations.psm1"
    },
    {
      "path": "DeleteGroup/PowerShell/ReportOperations.psm1"
    },
    {
      "path": "DeleteGroup/PowerShell/DatasourceOperations.psm1"
    },
    {
      "path": "DeleteGroup/PowerShell/GatewayOperations.psm1"
    },
    {
      "path": "DeleteGroup/PowerShell/Microsoft.IdentityModel.Clients.ActiveDirectory.dll"
    },
    {
      "path": "DeleteGroup/PowerShell/Microsoft.IdentityModel.Clients.ActiveDirectory.WindowsForms.dll"
    },
    {
      "path": "DeleteGroup/runtask.ps1"
    },
    {
      "path": "DeleteGroup/ps_modules"
    },
    {
      "path": "DeleteGroup/ps_modules/VstsTaskSdk"
    },
    {
      "path": "DeleteGroup/task.json"
    },
    {
      "path": "DeleteGroup/ps_modules/VstsTaskSdk/VstsTaskSdk.dll"
    },
    {
      "path": "UploadFiletoGroup"
    },
    {
      "path": "UploadFiletoGroup/icon.png"
    },
    {
      "path": "UploadFiletoGroup/PowerShell/Library.psm1"
    },
    {
      "path": "UploadFiletoGroup/PowerShell/CapacityOperations.psm1"
    },
    {
      "path": "UploadFiletoGroup/PowerShell/DatasetOperations.psm1"
    },
    {
      "path": "UploadFiletoGroup/PowerShell/TableOperations.psm1"
    },
    {
      "path": "UploadFiletoGroup/PowerShell/RowOperations.psm1"
    },
    {
      "path": "UploadFiletoGroup/PowerShell/GroupOperations.psm1"
    },
    {
      "path": "UploadFiletoGroup/PowerShell/ImportOperations.psm1"
    },
    {
      "path": "UploadFiletoGroup/PowerShell/DashboardOperations.psm1"
    },
    {
      "path": "UploadFiletoGroup/PowerShell/ReportOperations.psm1"
    },
    {
      "path": "UploadFiletoGroup/PowerShell/DatasourceOperations.psm1"
    },
    {
      "path": "UploadFiletoGroup/PowerShell/GatewayOperations.psm1"
    },
    {
      "path": "UploadFiletoGroup/PowerShell/Microsoft.IdentityModel.Clients.ActiveDirectory.dll"
    },
    {
      "path": "UploadFiletoGroup/PowerShell/Microsoft.IdentityModel.Clients.ActiveDirectory.WindowsForms.dll"
    },
    {
      "path": "UploadFiletoGroup/runtask.ps1"
    },
    {
      "path": "UploadFiletoGroup/ps_modules"
    },
    {
      "path": "UploadFiletoGroup/ps_modules/VstsTaskSdk"
    },
    {
      "path": "UploadFiletoGroup/task.json"
    },
    {
      "path": "UploadFiletoGroup/ps_modules/VstsTaskSdk/VstsTaskSdk.dll"
    },
    {
      "path": "DeleteReport"
    },
    {
      "path": "DeleteReport/icon.png"
    },
    {
      "path": "DeleteReport/PowerShell/Library.psm1"
    },
    {
      "path": "DeleteReport/PowerShell/CapacityOperations.psm1"
    },
    {
      "path": "DeleteReport/PowerShell/DatasetOperations.psm1"
    },
    {
      "path": "DeleteReport/PowerShell/TableOperations.psm1"
    },
    {
      "path": "DeleteReport/PowerShell/RowOperations.psm1"
    },
    {
      "path": "DeleteReport/PowerShell/GroupOperations.psm1"
    },
    {
      "path": "DeleteReport/PowerShell/ImportOperations.psm1"
    },
    {
      "path": "DeleteReport/PowerShell/DashboardOperations.psm1"
    },
    {
      "path": "DeleteReport/PowerShell/ReportOperations.psm1"
    },
    {
      "path": "DeleteReport/PowerShell/DatasourceOperations.psm1"
    },
    {
      "path": "DeleteReport/PowerShell/GatewayOperations.psm1"
    },
    {
      "path": "DeleteReport/PowerShell/Microsoft.IdentityModel.Clients.ActiveDirectory.dll"
    },
    {
      "path": "DeleteReport/PowerShell/Microsoft.IdentityModel.Clients.ActiveDirectory.WindowsForms.dll"
    },
    {
      "path": "DeleteReport/runtask.ps1"
    },
    {
      "path": "DeleteReport/ps_modules"
    },
    {
      "path": "DeleteReport/ps_modules/VstsTaskSdk"
    },
    {
      "path": "DeleteReport/task.json"
    },
    {
      "path": "DeleteReport/ps_modules/VstsTaskSdk/VstsTaskSdk.dll"
    }
  ],
  "contributions": [
    {
      "id": "ImportFile",
      "type": "ms.vss-distributed-task.task",
      "description": "Task to import a file into PowerBI",
      "targets": [
        "ms.vss-distributed-task.tasks"
      ],
      "properties": {
        "name": "ImportFile"
      }
    },
    {
      "id": "ImportFileToGroup",
      "type": "ms.vss-distributed-task.task",
      "description": "Task to import a file into a PowerBI Group",
      "targets": [
        "ms.vss-distributed-task.tasks"
      ],
      "properties": {
        "name": "ImportFileToGroup"
      }
    },
    {
      "id": "AddGroup",
      "description": "Add a Power BI Workspace (Group) using the Power BI API",
      "type": "ms.vss-distributed-task.task",
      "targets": [ "ms.vss-distributed-task.tasks" ],
      "properties": {
        "name": "AddGroup"
      }
    },
    {
      "id": "UploadFiletoGroup",
      "description": "Upload a pbix file from VSTS to the Power BI Portal using API calls",
      "type": "ms.vss-distributed-task.task",
      "targets": [ "ms.vss-distributed-task.tasks" ],
      "properties": {
        "name": "UploadFiletoGroup"
      }
    },
    {
      "id": "DeleteGroup",
      "description": "Delete a Power BI Workspace (Group) using the Power BI API",
      "type": "ms.vss-distributed-task.task",
      "targets": [ "ms.vss-distributed-task.tasks" ],
      "properties": {
        "name": "DeleteGroup"
      }
    },
    {
      "id": "DeleteReport",
      "description": "Delete a report from Power BI using the API",
      "type": "ms.vss-distributed-task.task",
      "targets": [ "ms.vss-distributed-task.tasks" ],
      "properties": {
        "name": "DeleteReport"
      }
    },
    {
      "id": "service-endpoint",
      "description": "Service Endpoint type for Power BI connections",

      "type": "ms.vss-endpoint.service-endpoint-type",
      "targets": [ "ms.vss-endpoint.endpoint-types" ],
      "properties": {
        "name": "PowerBI",
        "displayName": "Power BI API",
        "headers": [
          {
            "name": "Authorization",
            "value": "{{endpoint.apitoken}}"
          }
        ],
        "url": {
          "displayName": "Power BI API Url",
          "helpText": "Url for the Power BI API. https://api.powerbi.com/v1.0/"
        },
        "dataSources": [
          {
            "name": "Power BI API",
            "endpointUrl": "{{endpoint.url}}api/projects/index",
            "resultSelector": "jsonpath:$[*].nm"
          }

        ],
        "authenticationSchemes": [
          {
            "type": "ms.vss-endpoint.endpoint-auth-scheme-token"
          },
          {
            "type": "ms.vss-endpoint.endpoint-auth-scheme-basic",
            "inputDescriptors": [
              {
                "id": "username",
                "name": "Username",
                "description": "Username to use for connection to the Power BI API",
                "inputMode": "textbox",
                "validation": {
                  "isRequired": true,
                  "dataType": "string"
                }
              },
              {
                "id": "password",
                "name": "Password",
                "description": "Password of the user connecting to the Power BI API",
                "inputMode": "passwordbox",
                "isConfidential": true,
                "validation": {
                  "isRequired": true,
                  "dataType": "string"
                }
              },
              {
                "id": "clientid",
                "name": "ClientID",
                "description": "ClientID",
                "inputMode": "textbox",
                "isConfidential": false,
                "validation": {
                  "isRequired": true,
                  "dataType": "string"
                }
              }
            ]
          }

        ],
        "helpMarkDown": "<a href=\"documentation\" target=\"_blank\"><b>Learn More</b></a>"
      }
    }
  ]
}